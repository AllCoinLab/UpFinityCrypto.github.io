<!DOCTYPE html>
<html lang="en">
<link rel="shortcut icon" href="./assets/img/logo.png" />
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>UpFinity - World's Most Innovative Token</title>
  <meta name="description" content="UpFinity(UPF) is the World's Most Innovative Token with 23+ Fully New Unique Features">
  <meta name="og:title" content="UpFinity(UPF) is the World's Most Innovative Token with 23+ Fully New Unique Features">
  <meta name="twitter:title" content="UpFinity(UPF) is the World's Most Innovative Token with 23+ Fully New Unique Features">
  <meta name="keywords" content="UpFinity,UPF,bitcoin,dogecoin,doge,defi,coinbase,coinmarketcap,coinmarket,bscscan,whitebit,coingecko,cryptocurrency,crypto,pancakeswap,dex,ethereum,eth,btc">
  <meta name="og:image" content="{% static 'assets/img/logo.png' %}" />
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="{% static 'assets/img/logo.png' %}" />
  <meta name="twitter:title" content="UpFinity Coin Vote Site">
  
  <meta content="UpFinity,UPF,bitcoin,dogecoin,doge,defi,coinbase,coinmarketcap,coinmarket,bscscan,whitebit,coingecko,cryptocurrency,crypto,pancakeswap,dex,ethereum,eth,btc" name="keywords">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <!-- blockchains -->
  <script src="assets/js/web3.min.js" type="text/javascript" ></script>
  <script src="https://unpkg.com/@metamask/detect-provider/dist/detect-provider.min.js"></script>
  <script src="assets/js/ethers.umd.min.js" type="application/javascript"></script>
  
  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="shortcut icon">
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto|Oswald:300,400,700|Teko:400,600" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- Vendor CSS Files -->
  <!-- <link rel="stylesheet" href="assets/css/theme.min.css"> -->
  <!-- <link rel="stylesheet" href="assets/css/materialize.min.css"> -->
  
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link href="assets/vendor/font-awesome/css/fontawesome-all.min.css" rel="stylesheet">
  
  
  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
 
            
  <!-- =======================================================
  * Template Name: MyResume - v4.5.0
  * Template URL: https://bootstrapmade.com/free-html-bootstrap-template-my-resume/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Mobile nav toggle button ======= -->
  <!-- <button type="button" class="mobile-nav-toggle d-xl-none"><i class="bi bi-list mobile-nav-toggle"></i></button> -->
  <i class="bi bi-list mobile-nav-toggle d-xl-none"></i>
  <!-- ======= Header ======= -->


  <main id="main">
      <!-- ======= About Section ======= -->
    <section id="Ecosystem" class="about">
      <div id="NFT" class="container aos-init aos-animate" data-aos="fade-up">
        <div class="section-title">
          <h2>NFT</h2>
          <span class="wrap-address">
            <a href="https://bscscan.com/address/0x7AECf6381b637a5bA68A19df35Ba963774a777Bd" target="_tab">0x7AECf6381b637a5bA68A19df35Ba963774a777Bd
            </a>
            <a id="copyUpfinityNFTAdr" class="button scrollto" onclick="copyAdr('copyUpfinityNFTAdr', '0x7AECf6381b637a5bA68A19df35Ba963774a777Bd');">
              Copy
            </a>
          </span>
          <p></p>
          <div class="text-center" style="margin-top:25px;">
              <a href="#null" id="connect" class="button scrollto" onclick="fconnect();">Connect Wallet</a>
              <div id="connectResult"><span><span></div>
          </div>
          <p>Total Minted: <span id="totalNFTCount"></span></p>
        </div>
        
        
        <div class="row">
          <div class="col-12 col-lg-6 text-justify content">
            <div class="section-title">
              <h2>diamond</h2>
              <p>Need to hold at least: <img src="assets/img/logo.png" style="width: 30px;"> 2B UPF</p>
              <p>Price: <img src="assets/img/trade/bin.ico"> 0.25 BNB</p>
              <div class="row">
                <div class="col-12 col-lg-6 text-justify content">
                  <img id="diamondBoy" src="" style="width: 30px;">
                  <p>Minted: <span id="diamondBoyCount"></span></p>
                  <p><a href="#null" class="button scrollto" onclick="mintNFT('diamond', true);">Mint</a></p>
                  <p id="mintDiamondBoyResult"></p>
                </div>
                <div class="col-12 col-lg-6 text-justify content">
                  <img id="diamondGirl" src="" style="width: 30px;">
                  <p>Minted: <span id="diamondGirlCount"></span></p>
                  <p><a href="#null" class="button scrollto" onclick="mintNFT('diamond', false);">Mint</a></p>
                  <p id="mintDiamondGirlResult"></p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-12 col-lg-6 text-justify content">
            <div class="section-title">
              <h2>emerald</h2>
              <p>Need to hold at least: <img src="assets/img/logo.png" style="width: 30px;"> 20B UPF</p>
              <p>Price: <img src="assets/img/trade/bin.ico"> 0.5 BNB</p>
              <div class="row">
                <div class="col-12 col-lg-6 text-justify content">
                  <img id="emeraldBoy" src="" style="width: 30px;">
                  <p>Minted: <span id="emeraldBoyCount"></span></p>
                  <p><a href="#null" class="button scrollto" onclick="mintNFT('emerald', true);">Mint</a></p>
                  <p id="mintEmeraldBoyResult"></p>
                </div>
                <div class="col-12 col-lg-6 text-justify content">
                  <img id="emeraldGirl" src="" style="width: 30px;">
                  <p>Minted: <span id="emeraldGirlCount"></span></p>
                  <p><a href="#null" class="button scrollto" onclick="mintNFT('emerald', false);">Mint</a></p>
                  <p id="mintEmeraldGirlResult"></p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      swap
      <div>
        <div>Input</div>
        <div>Balance: <div id="BNBbalance"></div> BNB</div>
        <input id="source">
      </div>
      <div>
        <div>Output</div>
        <div>Balance: <div id="UPFbalance"></div> UPF </div>
        <div id="result"></div>
      </div>
      <a class="button scrollto" onClick="buyUPF();">SWAP</a>
      
      <div class="col-6">
    <div class="sc-iemWCZ hvoWDu sc-dprnXS eyUYsL">
	<div class="sc-jSFjdj sc-dIvrsQ kJmatq hdzOgI">
		<div class="sc-jSFjdj sc-gKAaRy sc-vMGZd kJmatq jcNvwq jsAPRX">
			<div class="sc-jSFjdj sc-gKAaRy cpromH togOu">
				<div class="sc-jSFjdj sc-gKAaRy kJmatq iIdAKa">
					<h2 color="text" class="sc-gtsrHT sc-kLojOw iGtzpP jDXLmf text-center">Exchange</h2>
					<div class="sc-jSFjdj sc-gKAaRy kJmatq togOu text-center">
						<div color="textSubtle" font-size="14px" class="sc-gtsrHT llSJBl">Trade tokens in an instant</div>
					</div>
				</div>
			</div>
			
		</div>
		<div id="swap-page" class="sc-gpEJdM jdQeRJ">
			<div class="sc-enrZtP cXbVbC">
				<div id="swap-currency-input" class="sc-hLiTib isUOgq" style="
    border-radius: 16px;
    background-color: rgb(238, 234, 244);
    box-shadow: rgb(74 74 104 / 10%) 0px 2px 2px -1px inset;
    ">
					<div class="sc-eTTTle hCspWz" style="
    padding: 15px;
">
						<div class="sc-fSvVUw fLBCdk" style="justify-content: space-between;">
							<div class="sc-jSFjdj sc-knSFqH sc-kSCemg kJmatq gIlUEd OGHxE" style="
    display: flex; justify-content: space-between;
">
								<div font-size="14px" color="text" class="sc-gtsrHT jFEWVt">From</div>
<div font-size="14px" color="text" class="sc-gtsrHT jFEWVt" style="display: inline; cursor: pointer;">Balance: <div id="BNBbalance"></div></div>
</div>

						</div>
						<div class="sc-fVnRWS idBnak" style="
    display: flex;
">
							<input class="sc-iMCRTP iOdHiq token-amount-input source" inputmode="decimal" title="Token Amount" autocomplete="off" autocorrect="off" type="text" pattern="^[0-9]*[.,]?[0-9]*$" placeholder="0.0" minlength="1" maxlength="79" spellcheck="false" value="">
								<button class="sc-hKFxyN jYLfuR sc-iJKVRt eyGnew open-currency-select-button" scale="sm" style="
    justify-content: space-between;
    border: 0px;
    background-color: #00000000;
">
									<div class="sc-jSFjdj sc-gKAaRy kJmatq eqGhLO" style="
    justify-content: space-between;
    display: flex;
    align-items: center;
">
										<svg viewBox="0 0 16 16" width="24px" color="text" xmlns="http://www.w3.org/2000/svg" class="sc-bdnxRM kDWlca" style="/* margin-right: 8px; */justify-content: space-between;display: flex;">
											<circle cx="8" cy="8" r="8" fill="#F0B90B"></circle>
											<path d="M5.01656 8.00006L3.79256 9.23256L2.56006 8.00006L3.79256 6.76756L5.01656 8.00006ZM8.00006 5.01656L10.1081 7.12456L11.3406 5.89206L9.23256 3.79256L8.00006 2.56006L6.76756 3.79256L4.66806 5.89206L5.90056 7.12456L8.00006 5.01656ZM12.2076 6.76756L10.9836 8.00006L12.2161 9.23256L13.4401 8.00006L12.2076 6.76756ZM8.00006 10.9836L5.89206 8.87556L4.66806 10.1081L6.77606 12.2161L8.00006 13.4401L9.23256 12.2076L11.3406 10.0996L10.1081 8.87556L8.00006 10.9836ZM8.00006 9.23256L9.23256 8.00006L8.00006 6.76756L6.76756 8.00006L8.00006 9.23256Z" fill="#FFFDFA"></path>
										</svg>
										<div id="pair" color="text" class="sc-gtsrHT MlLjM" style="
    display: flex;
    text-align: left;
    margin: 10px;
">BNB</div>
										
									</div>
								</button>
							</div>
						</div>
					</div>
					<div class="sc-enrZtP jMLgAG">
						<div class="sc-jSFjdj sc-knSFqH sc-cfARRi kJmatq chNVSQ jttSjR" style="padding: 0px 1rem;">
							<div class="sc-cxxZvF bgTNhm">
								<svg viewBox="0 0 24 24" width="16px" color="text" xmlns="http://www.w3.org/2000/svg" class="sc-bdnxRM kDWlca">
									<path d="M11 5V16.17L6.11997 11.29C5.72997 10.9 5.08997 10.9 4.69997 11.29C4.30997 11.68 4.30997 12.31 4.69997 12.7L11.29 19.29C11.68 19.68 12.31 19.68 12.7 19.29L19.29 12.7C19.68 12.31 19.68 11.68 19.29 11.29C18.9 10.9 18.27 10.9 17.88 11.29L13 16.17V5C13 4.45 12.55 4 12 4C11.45 4 11 4.45 11 5Z"></path>
								</svg>
							</div>
						</div>
					</div>
<div id="swap-currency-input" class="sc-hLiTib isUOgq" style="
    border-radius: 16px;
    background-color: rgb(238, 234, 244);
    box-shadow: rgb(74 74 104 / 10%) 0px 2px 2px -1px inset;
    ">
					<div class="sc-eTTTle hCspWz" style="
    padding: 15px;
">
						<div class="sc-fSvVUw fLBCdk" style="justify-content: space-between;">
							<div class="sc-jSFjdj sc-knSFqH sc-kSCemg kJmatq gIlUEd OGHxE" style="
    display: flex; justify-content: space-between;
">
								<div font-size="14px" color="text" class="sc-gtsrHT jFEWVt">To</div>
<div font-size="14px" color="text" class="sc-gtsrHT jFEWVt" style="display: inline; cursor: pointer;">Balance: <div id="UPFbalance"></div></div>
</div>

						</div>
						<div class="sc-fVnRWS idBnak" style="
    display: flex;
">
							<input class="sc-iMCRTP iOdHiq token-amount-input result" inputmode="decimal" title="Token Amount" autocomplete="off" autocorrect="off" type="text" pattern="^[0-9]*[.,]?[0-9]*$" placeholder="0.0" minlength="1" maxlength="79" spellcheck="false" value="">
								<button class="sc-hKFxyN jYLfuR sc-iJKVRt eyGnew open-currency-select-button" scale="sm" style="
    justify-content: space-between;
    border: 0px;
    background-color: #00000000;
">
									<div class="sc-jSFjdj sc-gKAaRy kJmatq eqGhLO" style="
    justify-content: space-between;
    display: flex;
    align-items: center;
">
										<img src="assets/img/logo.png" style="width: 30px;">
										<div id="pair" color="text" class="sc-gtsrHT MlLjM" style="
    display: flex;
    text-align: left;
    margin: 10px;
">UPF</div>
										
									</div>
								</button>
							</div>
						</div>
					</div>

					
						<div class="sc-enrZtP bxRIiB" style="padding: 0px 16px;"></div>
					</div>
					<div class="sc-jSFjdj jRqThc">
						<div class="sc-jSFjdj jRqThc"><button class="sc-hKFxyN hizvcO" id="swap-button" width="100%" scale="md" style="
    -webkit-box-align: center;
    align-items: center;
    border: 0px;
    border-radius: 16px;
    box-shadow: rgb(14 14 44 / 40%) 0px -1px 0px 0px inset;
    cursor: pointer;
    display: inline-flex;
    font-family: inherit;
    font-size: 16px;
    font-weight: 600;
    -webkit-box-pack: center;
    justify-content: center;
    letter-spacing: 0.03em;
    line-height: 1;
    opacity: 1;
    outline: 0px;
    transition: background-color 0.2s ease 0s, opacity 0.2s ease 0s;
    height: 48px;
    padding: 0px 24px;
    margin: 10px 0px;
    background-color: rgb(40 167 69);
    color: white;
    width: 100%;
    " onClick="buyUPF();">Swap</button></div>
					</div>
				</div>
			</div>
		</div></div>
    </section>

  <!-- Vendor JS Files -->
  <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script async src="assets/vendor/purecounter/purecounter.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/typed.js/typed.min.js"></script>
  <script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
  <script src="assets/vendor/chart.js/chart.min.js"></script>
  
  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  
  <!-- <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script> -->
  <!-- <script type="text/javascript" src="assets/js/materialize.min.js"></script> -->

  <script src="assets/js/funcs.js"></script>
  <script src="assets/js/consts.js"></script>

  <script type="text/javascript">  
  
  (async function() { // to use async things

  
  
  
  /////////////////////////////////////////////////////////////
  // inits

  if (location.hostname == "") {
    console.log('local');
    return;

  }
  
  if (typeof window.ethereum === 'undefined') {
    console.log('no dapp');
    return;
  }
    
  ethereum.on('chainChanged', handleChainChanged);
  ethereum.on('accountsChanged', handleAccountsChanged);
    
  provider = new ethers.providers.Web3Provider(window.ethereum);
  signer = provider.getSigner();    
  
  network = await provider.getNetwork();
  chainId = network.chainId;
  if (chainId == 56) {
    console.log('mainnet');
    rewardAdr = '0x373764c3deD9316Af3dA1434ccba32caeDeC09f5';
    freeAirdropAdr = '0x17f90D36E2B11999CBEbf5E36e09E7079Ea9e2a4';
    airdropAdr = '0x53a1239a6C3c0cD6458C7Ee9c07815544a537004';
    nftAdr = '0x7AECf6381b637a5bA68A19df35Ba963774a777Bd';
  } else {
    alert('Change to BSC network and refresh!');
    return;
    console.log('testnet');
    rewardAdr = '0x0C646ba1295e6d725174D6Ae6C9748788D99e492';
  }
    
  routerC = new ethers.Contract(routerAdr, routerAbi, provider);
  
  factoryData = await routerC.functions.factory();
  factoryAdr = factoryData[0];
  factoryC = new ethers.Contract(factoryAdr, factoryAbi, provider);
  
  pairData = await factoryC.functions.getPair(wbnbAdr, upfinityAdr);
  pairAdr = pairData[0];
  pairC = new ethers.Contract(pairAdr, pairAbi, provider);
  
  upfinityC = new ethers.Contract(upfinityAdr, upfinityAbi, provider);
  rewardC = new ethers.Contract(rewardAdr, rewardAbi, provider);
  freeAirdropC = new ethers.Contract(freeAirdropAdr, freeAirdropAbi, provider);
  airdropC = new ethers.Contract(airdropAdr, airdropAbi, provider);
  nftC = new ethers.Contract(nftAdr, nftAbi , provider);
  
  // refAdr = GetURLParameter("ref");
  // x = document.getElementById("referralAdrDisplay");
  // if (typeof refAdr === 'undefined') {
  //   x.innerHTML = 'None';
  // } else {
  //   refAdr = getChecksumAddress(refAdr);
  //   if (refAdr == '') {
  //     x.innerHTML = 'Wrong Format';
  //   } else {
  //     x.innerHTML = refAdr;
  //   }
  // }
  
  // without wallet connection
  
  // constants
  
  totalSupply = (await upfinityC.functions.totalSupply())[0];
  
  _accuMulFactor = (await upfinityC.functions._accuMulFactor())[0] / 1;
  
  _accuTaxTimeWindow = (await upfinityC.functions._accuTaxTimeWindow())[0] / 1;
  _curcuitBreakerTime = (await upfinityC.functions._curcuitBreakerTime())[0] / 1;
  _curcuitBreakerDuration = (await upfinityC.functions._curcuitBreakerDuration())[0] / 1;
  _curcuitBreakerThreshold = (await upfinityC.functions._curcuitBreakerThreshold())[0] / 1;
  _taxAccuTaxCheckGlobal = (await upfinityC.functions._taxAccuTaxCheckGlobal())[0] / 1;
  _curcuitBreakerFlag = (await upfinityC.functions._curcuitBreakerFlag())[0] / 1;
  
  _accuTaxTimeWindow = (await upfinityC.functions._accuTaxTimeWindow())[0] / 1;
  _airdropSystem = (await upfinityC.functions._airdropSystem())[0] / 1;
  _antiDumpDuration = (await upfinityC.functions._antiDumpDuration())[0] / 1;
  _autoBurnFee = (await upfinityC.functions._autoBurnFee())[0] / 1;
  _buySellTimeDuration = (await upfinityC.functions._buySellTimeDuration())[0] / 1;
  _curcuitBreakerDuration = (await upfinityC.functions._curcuitBreakerDuration())[0] / 1;
  _curcuitBreakerThreshold = (await upfinityC.functions._curcuitBreakerThreshold())[0] / 1;
  _dipRewardFee = (await upfinityC.functions._dipRewardFee())[0] / 1;
  _dividendPartyThreshold = (await upfinityC.functions._dividendPartyThreshold())[0]; // big number
  _freeAirdropSystem = (await upfinityC.functions._freeAirdropSystem())[0] / 1;
  _improvedRewardFee = (await upfinityC.functions._improvedRewardFee())[0] / 1;
  _liquidityFee = (await upfinityC.functions._liquidityFee())[0] / 1;
  _manualBuyFee = (await upfinityC.functions._manualBuyFee())[0] / 1;
  _maxBalanceNume = (await upfinityC.functions._maxBalanceNume())[0] / 1;
  _maxSellNume = (await upfinityC.functions._maxSellNume())[0] / 1;
  _maxTxNume = (await upfinityC.functions._maxTxNume())[0] / 1;
  _minusTaxBonus = (await upfinityC.functions._minusTaxBonus())[0] / 1;
  _taxAccuTaxThreshold = (await upfinityC.functions._taxAccuTaxThreshold())[0] / 1;
  _timeAccuTaxCheckGlobal = (await upfinityC.functions._timeAccuTaxCheckGlobal())[0] / 1;
  _whaleRate = (await upfinityC.functions._whaleRate())[0] / 1;
  _whaleSellFee = (await upfinityC.functions._whaleSellFee())[0] / 1;
  _whaleTransferFee = (await upfinityC.functions._whaleTransferFee())[0] / 1;
  
  _antiDumpTimer = (await upfinityC.functions._antiDumpTimer())[0] / 1;
  
  multiplier = 1 + 600 / 2000;
  displayText("_accuMulFactor", _accuMulFactor);
  displayText("_accuTaxTimeWindow", _accuTaxTimeWindow / 60 / 60 / 24);
  displayText("_airdropSystem", _airdropSystem);
  displayText("_antiDumpDuration", _antiDumpDuration / 60);
  displayText("_autoBurnFee", _autoBurnFee * multiplier / 100);
  displayText("_buySellTimeDuration", _buySellTimeDuration / 60);
  displayText("_curcuitBreakerDuration", _curcuitBreakerDuration / 60 / 60);
  displayText("_curcuitBreakerThreshold", _curcuitBreakerThreshold / 100);
  displayText("_dipRewardFee", _dipRewardFee * multiplier / 100);
  displayText("_dividendPartyThreshold", numberWithCommas(_dividendPartyThreshold / 1e18));
  displayText("_freeAirdropSystem", _freeAirdropSystem);
  displayText("_improvedRewardFee", _improvedRewardFee * multiplier / 100);
  displayText("_liquidityFee", _liquidityFee * multiplier / 100 * 2); // double
  displayText("_manualBuyFee", _manualBuyFee * multiplier / 100);
  displayText("_maxBalanceNume", _maxBalanceNume / 100);
  displayText("_maxSellNume", _maxSellNume / 100);
  displayText("_maxTxNume", _maxTxNume / 100);
  displayText("_minusTaxBonus", _minusTaxBonus / 100);
  <!-- displayText("_rewardToken", (await upfinityC.functions._rewardToken())[0] / 100); -->
  displayText("_taxAccuTaxThreshold", _taxAccuTaxThreshold / 100);
  displayText("_timeAccuTaxCheckGlobal", _timeAccuTaxCheckGlobal / 60 / 60 / 24);
  displayText("_whaleRate", _whaleRate / 10000);
  displayText("_whaleSellFee", _whaleSellFee / 10000);
  displayText("_whaleTransferFee", _whaleTransferFee / 10000);
  
  _projectFundFee = (await upfinityC.functions._projectFundFee())[0] / 1;
  redistributionFee = (2000 - _manualBuyFee) - _autoBurnFee - (10000 - (2000 - _manualBuyFee)) * 0 / 100 - (_liquidityFee + _projectFundFee + _improvedRewardFee + _dipRewardFee) - _liquidityFee;
  
  displayText("redistributionFee", redistributionFee * multiplier / 100);
  
  connectWalletText = "<span>Loading, Connect wallet to use claim, etc!</span>";
  displayText("connectResult", connectWalletText);
  displayText("balanceStatus", connectWalletText);
  <!-- displayText("balanceIcon", connectWalletText); --> // big icon
  displayText("oneBuyLimitStatus", connectWalletText);
  displayText("oneSellLimitStatus", connectWalletText);
  
  displayText("claimable", connectWalletText);
  displayText("claimed", connectWalletText);
  
  document.getElementById("source").value = 'Loading..';
  
  
  reserveData = await pairC.functions.getReserves();
  
  if (wbnbAdr < upfinityAdr) { // BNB / UpFinity
    rI = reserveData[0]; 
    rO = reserveData[1];
  } else {
    rI = reserveData[1];
    rO = reserveData[0];
  }
  
  totalLpSupply = (await pairC.functions.totalSupply())[0];
  
  maxBuyUPF = rO.mul(1000).div(10000); // 10% of current liquidity
  maxBuyBNB = (await routerC.functions.getAmountIn(maxBuyUPF, rI, rO))[0];
  

  sellCooltime = 0;
  sellCooltime_ = _curcuitBreakerTime + _curcuitBreakerDuration + 1.5 * 60 * 60;
  
  if (_curcuitBreakerThreshold / 1 <= _taxAccuTaxCheckGlobal / 1) {
    if (sellCooltime / 1 < sellCooltime_ / 1) {
      sellCooltime = sellCooltime_;
      d = new Date(sellCooltime * 1000);
      displayText("sellCooltime", d);
    }
  }

  
  communityToken = "0x000000000000000000000000000000000000dEaD";
  
  // airdrop
  freeAirdropBalance = (await upfinityC.functions.balanceOf(freeAirdropAdr))[0];
  dollarsPerBNB = (await airdropC.functions._dollarsPerBNB())[0] / 1;
  oneDollarBNB = 1 / dollarsPerBNB; // 1 BNB = 400$ for simplicity + optimize gas fee
  oneDollarUPF = (await routerC.functions.getAmountOut(ethers.utils.parseEther(oneDollarBNB.toString()), rI, rO))[0];
  _freeAirdropSystem = (await upfinityC.functions._freeAirdropSystem())[0]
  displayText("freeAirdropBalance", "Free Airdrop (" + _freeAirdropSystem + ") balance: [" + numberWithCommas(Math.floor(freeAirdropBalance.div(oneDollarUPF) / 1)) + " $]");
  
  airdropBalance = (await upfinityC.functions.balanceOf(airdropAdr))[0];
  _airdropSystem = (await upfinityC.functions._airdropSystem())[0]
  displayText("airdropBalance", "Airdrop (" + _airdropSystem + ") balance: [" + numberWithCommas(Math.floor(airdropBalance.div(oneDollarUPF) / 1)) + "$]");
  
  
  balanceInfo = await provider.getBalance(rewardAdr);
  balance = BNB(ethers.utils.formatEther(balanceInfo) * bnbDiv);
  displayText("totalUnclaimed", balance.toString() + ' BNB');
  
  burnAdr = "0x000000000000000000000000000000000000dEaD";
  burnAmount = (await upfinityC.functions.balanceOf(burnAdr))[0];
  burnPercentage = burnAmount.mul(100).div(totalSupply);
  burnPercentage = burnPercentage.sub(50); // 50% burn at the start
  displayText("_manualburned", round(burnPercentage / 1, 1));
  burnLpAmount = (await pairC.functions.balanceOf(burnAdr))[0];
  burnLpPercentage = burnLpAmount.mul(100).div(totalLpSupply);
  displayText("_manuallpburned", round(burnLpPercentage / 1, 1));
  
  bnbAmount = rI / 1e18;
  tokenAmount = rO / 10 ** decimals;
  
  
  // without wallet connection
  busdAdr = "0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56";
  pricePairAdr = (await factoryC.functions.getPair(wbnbAdr, busdAdr))[0];
  pricePairC = new ethers.Contract(pricePairAdr, pairAbi, provider);
  priceReserveData = await pricePairC.functions.getReserves();
  
  if (wbnbAdr < busdAdr) { // BNB / busd
    pricerI = priceReserveData[0]; 
    pricerO = priceReserveData[1];
  } else {
    pricerI = priceReserveData[1];
    pricerO = priceReserveData[0];
  }
  
  price = rI / rO * pricerO / pricerI; // TODO: WBNB-BUSD, same decimal
  realSupply = totalSupply.sub(burnAmount);
  mcap = price * realSupply / 10 ** decimals;
  
  // var elms_ = document.querySelectorAll("[id='priceCounter']");
  // elms_[0].setAttribute('data-purecounter-end', (price / 1).toFixed(10));
  // var elms_ = document.querySelectorAll("[id='burnCounter']");
  // elms_[0].setAttribute('data-purecounter-end', burnAmount / 1e18);
  // var elms_ = document.querySelectorAll("[id='circulateCounter']");
  // elms_[0].setAttribute('data-purecounter-end', realSupply / 1e18);
  // var elms_ = document.querySelectorAll("[id='marketcapCounter']");
  // elms_[0].setAttribute('data-purecounter-end', mcap.toFixed(0));
  // var elms_ = document.querySelectorAll("[id='manualBurnCounter']");
  // elms_[0].setAttribute('data-purecounter-end', burnPercentage);
  // var elms_ = document.querySelectorAll("[id='manualLPBurnCounter']");
  // elms_[0].setAttribute('data-purecounter-end', burnLpPercentage);
  
  // var elms_ = document.querySelectorAll("[id='startMultiCounter']");
  // elms_[0].setAttribute('data-purecounter-end', mcap.toFixed(0) / 333);
  
  
  upfinityBalance = (await upfinityC.functions.balanceOf(upfinityAdr))[0];
  partyImpact = 0;
  if (_dividendPartyThreshold * 0.9 < upfinityBalance / 1) {
    displayText("dividendPartyStatus", "READY");
    partyImpact = _dividendPartyThreshold.div(rO) * 100; // roughly
    displayText("dividendPartyImpactMin", (partyImpact * 1).toFixed(1));
    displayText("dividendPartyImpactMax", (partyImpact * 2).toFixed(1));
  } else {
    displayText("dividendPartyStatus", "OFF");
  }
  
  
  
  // personal wallet infos
  
  currentAccount = await afconnect();
  
  balance = (await upfinityC.functions.balanceOf(currentAccount))[0];
  displayText("balanceStatus", numberWithCommas(Math.floor(balance / 1e18)));
  
  balancePercentage = round(balance / totalSupply * 100, 2);
  displayText("balancePercentageStatus", '(' + balancePercentage.toString() + ' %)');
  if (balancePercentage >= 1) {
    displayText("balanceIcon", String.fromCodePoint(0x1F40B)); // 🐳
  } else if (balancePercentage >= 0.3) {
    displayText("balanceIcon", String.fromCodePoint(0x1F988)); // 🦈
  } else if (balancePercentage >= 0.1) {
    displayText("balanceIcon", String.fromCodePoint(0x1F42C)); // 🐬
  } else if (balancePercentage >= 0.03) {
    displayText("balanceIcon", String.fromCodePoint(0x1F41F)); // 🐟
  } else if (balancePercentage >= 0.01) {
    displayText("balanceIcon", String.fromCodePoint(0x1F419)); // 🐙
  } else if (balancePercentage >= 0.003) {
    displayText("balanceIcon", String.fromCodePoint(0x1F980)); // 🦀
  } else if (balancePercentage >= 0.001) {
    displayText("balanceIcon", String.fromCodePoint(0x1F990)); // 🦐
  } 
  
  
  
  balanceLimit = totalSupply.mul(100).div(10000); // 1% of total supply
  
  if (balanceLimit / 1 <= balance / 1) { 
    displayText("oneBuyLimitStatus", 'already max!');
  } else {
    buyLimit = balanceLimit.sub(balance);
    maxBuyBNB_ = (await routerC.functions.getAmountIn(buyLimit, rI, rO))[0];
    if (maxBuyBNB / 1 < maxBuyBNB_ / 1) {
      displayText("oneBuyLimitStatus", round(maxBuyBNB / bnbDiv, 2) + ' BNB');
    } else { 
      displayText("oneBuyLimitStatus", round(maxBuyBNB_ / bnbDiv, 2) + ' BNB');
    }
  }
  
  
  
  // it may display last big value
  maxSellUPF = rO;
  maxSellRate_ = _curcuitBreakerThreshold - _taxAccuTaxCheckGlobal;
  if (maxSellRate_ < 0) {
    maxSellRate_ = 0;
  }
  maxSellUPF_ = rO.mul(maxSellRate_).div(10000);
  if (maxSellUPF_ / 1 < maxSellUPF / 1) {
    maxSellUPF = maxSellUPF_;
  }
  
  _timeAccuTaxCheck = (await upfinityC.functions._timeAccuTaxCheck(currentAccount))[0] / 1;
  _taxAccuTaxCheck = (await upfinityC.functions._taxAccuTaxCheck(currentAccount))[0] / 1;
  maxSellRate_ = _taxAccuTaxThreshold - _taxAccuTaxCheck; // reverted if exceed limit, so always little value left
  if (maxSellRate_ < 0) {
    maxSellRate_ = 0;
  }
  maxSellUPF_ = rO.mul(maxSellRate_).div(10000);
  if (maxSellUPF_ / 1 < maxSellUPF / 1) {
    maxSellUPF = maxSellUPF_;
  }
  
  <!-- maxSellBNB = (await routerC.functions.getAmountIn(maxSellUPF, rI, rO))[0]; -->
  maxSellBNB = maxSellUPF / rO * rI; // workaround
  maxSellBNB = BNB(maxSellBNB / 1.5); // roughly estimated
  displayText("oneSellLimitStatus", maxSellBNB.toString() + ' BNB'); 
  
  taxPenalty = 0;
  if (Date.now() < _timeAccuTaxCheck + _accuTaxTimeWindow) {
    taxPenalty = _taxAccuTaxCheck * _accuMulFactor / 100;
    if (15 < taxPenalty / 1) {
      taxPenalty = 15; // check
    }
  }
  displayText("yourTaxPenalty", taxPenalty);
  
  // price impact 1 / ( 1 + x / r0) = (1 - I)
  // smart contract, change x,r0 equation to 1 / (1 + x / r0) for exact result 
  // x / r0 = a => price diff = 1 / (1 + a)^2
  // for simplicity + safety, a = 0.08, 0.05

  // for user: price impact based limit
  // for graph: price change based limit
  // so need price impact - price change relation
  // price impact accumulation => user limit
  // price change accumulation => global limit
  // x / r0 = a => price change = 1 / (1 + a)^2
  
  
  sellCooltime_ = _antiDumpTimer + _antiDumpDuration;
  if (sellCooltime / 1 < sellCooltime_ / 1) {
    sellCooltime = sellCooltime_;
    d = new Date(sellCooltime * 1000);
    displayText("sellCooltime", d);
  }
  
  _buySellTimer = (await upfinityC.functions._buySellTimer(currentAccount))[0] / 1;
  sellCooltime_ = _buySellTimer + _buySellTimeDuration;
  if (sellCooltime / 1 < sellCooltime_ / 1) {
    sellCooltime = sellCooltime_;
    d = new Date(sellCooltime * 1000);
    displayText("sellCooltime", d);
  }
  
  blacklisted = (await upfinityC.functions.blacklisted(currentAccount))[0];
  
  
  
  if ((_curcuitBreakerFlag == 2) & (Date.now() < (_curcuitBreakerTime / 1 + _curcuitBreakerDuration / 1 + 1.5 * 60 * 60) * 1000)) {
      displayText("circuitBreakerStatus", "Circuit breaker ON");
  } else {
    if (Date.now() < _antiDumpTimer / 1 + _antiDumpDuration / 1) {
      displayText("circuitBreakerStatus", "last sell cooltime " + String(_antiDumpDuration) + "s");
    } else {
      if (Date.now() < _buySellTimer / 1 + _buySellTimeDuration / 1) {
        displayText("circuitBreakerStatus", "your last sell cooltime " + String(_buySellTimeDuration) + "s");
      } else {
        if (blacklisted) {
          displayText("circuitBreakerStatus", "if still can't sell, contact @ALLCOINLAB");
        } else {
          displayText("circuitBreakerStatus", "You can sell: check slippage and sell size!");
        }
      }
    }
  }
  
  base = 20;
  margin = 3;
  whaleTax = 0;
  impact = getImpact(tokenAmount, 10**7);
  if (10**7 / tokenAmount * 100 > 1) {
    whaleTax = 4;
  } else {
    whaleTax = 0;
  }
  displayText("10mSlippage", round(base + impact * _accuMulFactor + taxPenalty + partyImpact + whaleTax + margin, 1));
  impact = getImpact(tokenAmount, 10**8);
  if (10**8 / tokenAmount * 100 > 1) {
    whaleTax = 4;
  } else {
    whaleTax = 0;
  }
  displayText("100mSlippage", round(base + impact * _accuMulFactor + taxPenalty + partyImpact + whaleTax + margin, 1));
  impact = getImpact(tokenAmount, 10**9);
  if (10**9 / tokenAmount * 100 > 1) {
    whaleTax = 4;
  } else {
    whaleTax = 0;
  }
  displayText("1bSlippage", round(base + impact * _accuMulFactor + taxPenalty + partyImpact + whaleTax + margin, 1));
  impact = getImpact(tokenAmount, 10**10);
  if (10**10 / tokenAmount * 100 > 1) {
    whaleTax = 4;
  } else {
    whaleTax = 0;
  }
  displayText("10bSlippage", round(base + impact * _accuMulFactor + taxPenalty + partyImpact + whaleTax + margin, 1));
  
  displayText("devNotice", "<p>If numbers not showing correctly, it means dev is upgrading :)</p><p>IF having trouble for anything, DM @ALLCOINLAB</p><p>All value can be changed or different due to network status!</p>");
  
  
  
  
  var elms_ = document.querySelectorAll("[id='diamondBoy']");
  elms_[0].setAttribute('src', JSON.parse(loadFile("assets/0"))['image']);
  var elms_ = document.querySelectorAll("[id='diamondGirl']");
  elms_[0].setAttribute('src', JSON.parse(loadFile("assets/1"))['image']);
  var elms_ = document.querySelectorAll("[id='emeraldBoy']");
  elms_[0].setAttribute('src', JSON.parse(loadFile("assets/2"))['image']);
  var elms_ = document.querySelectorAll("[id='emeraldGirl']");
  elms_[0].setAttribute('src', JSON.parse(loadFile("assets/3"))['image']);
  
  
  diamondBoyCount = (await nftC.functions._totalItemCount(2))[0] / 1;
  displayText_("diamondBoyCount", diamondBoyCount);
  diamondGirlCount = (await nftC.functions._totalItemCount(3))[0] / 1;
  displayText_("diamondGirlCount", diamondGirlCount);
  emeraldBoyCount = (await nftC.functions._totalItemCount(0))[0] / 1;
  displayText_("emeraldBoyCount", emeraldBoyCount);
  emeraldGirlCount = (await nftC.functions._totalItemCount(1))[0] / 1;
  displayText_("emeraldGirlCount", emeraldGirlCount);
  
  displayText_("totalNFTCount", diamondBoyCount + diamondGirlCount + emeraldBoyCount + emeraldGirlCount);
  totalSupplyNFT = (await nftC.functions.totalSupply())[0] / 1;
  console.log(totalSupplyNFT);

  const source = document.getElementById('source');
  const result = document.getElementById('result');
  
  const inputHandler = function(e) {
      valueIn = e.target.value;
      if (valueIn == 0) {
        result.innerHTML = 0;
        return;
      }

      valueIn = ethers.utils.parseEther(valueIn);
      valueOut = rO.mul(valueIn).div(rI.add(valueIn));
      valueOut = ethers.utils.formatEther(valueOut);
      valueOut = parseInt(valueOut);
      result.innerHTML = numberWithCommas(valueOut);
  }
  
  source.addEventListener('input', inputHandler);
  source.addEventListener('propertychange', inputHandler); // for IE8
  // Firefox/Edge18-/IE9+ don’t fire on <select><option>
  // source.addEventListener('change', inputHandler); 

  document.getElementById("source").value = '0';

  balanceInfo = await provider.getBalance(currentAccount);
  balance = BNB(ethers.utils.formatEther(balanceInfo) * bnbDiv);
  displayText_("BNBbalance", parseInt(balance).toFixed(3));

  balance = (await upfinityC.functions.balanceOf(currentAccount))[0];
  displayText_("UPFbalance", numberWithCommas(Math.floor(balance / 1e18)));
  
  }());
  </script>
  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
  <div class="copyright">
    <iframe data-aa="1829702" src="//ad.a-ads.com/1829702?size=120x60" style="width:120px; height:60px; border:0px; padding:0; overflow:hidden; background-color: transparent;" ></iframe>
  </div>
</body>

</html>
